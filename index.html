<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Bible App by Yel Portillo</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');
  body {
    font-family: 'Inter', sans-serif;
    background: #f9fafb;
    margin: 0;
    padding: 40px 20px;
    display: flex;
    justify-content: center;
  }
  #container {
    background: white;
    max-width: 600px;
    width: 100%;
    padding: 30px 40px 40px;
    border-radius: 14px;
    box-shadow: 0 8px 24px rgb(0 0 0 / 0.1);
    text-align: center;
    position: relative;
  }
  h2 {
    font-weight: 600;
    margin-bottom: 12px;
  }
  #menu {
    position: absolute;
    top: 24px;
    right: 24px;
    font-size: 28px;
    cursor: pointer;
    user-select: none;
    color: #444;
  }
  ul.menu-items {
    position: absolute;
    top: 60px;
    right: 24px;
    background: white;
    box-shadow: 0 8px 24px rgb(0 0 0 / 0.1);
    border-radius: 10px;
    list-style: none;
    padding: 10px 0;
    margin: 0;
    width: 160px;
    display: none;
    z-index: 10;
  }
  ul.menu-items li {
    padding: 10px 20px;
    cursor: pointer;
    color: #222;
  }
  ul.menu-items li:hover {
    background-color: #f0f0f0;
  }
  #date {
    color: #666;
    margin-bottom: 20px;
    font-size: 14px;
  }
  #verse {
    font-weight: 400;
    font-size: 18px;
    margin-bottom: 14px;
    line-height: 1.5;
    color: #111;
  }
  #prayer {
    font-style: italic;
    font-size: 16px;
    color: #555;
    margin-bottom: 20px;
    white-space: pre-wrap;
  }
  #bible-image {
    width: 100%;
    max-height: 280px;
    object-fit: cover;
    border-radius: 12px;
    margin-bottom: 25px;
  }
  button {
    background-color: #2563eb;
    color: white;
    border: none;
    padding: 12px 28px;
    font-size: 16px;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.2s ease;
  }
  button:hover {
    background-color: #1d4ed8;
  }
  #prayerTab {
    margin-top: 40px;
  }
  #prayerTab h2 {
    font-weight: 600;
    margin-bottom: 16px;
  }
  #name, #prayerInput {
    width: 100%;
    max-width: 100%;
    margin-bottom: 12px;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #ddd;
    font-size: 16px;
    font-family: 'Inter', sans-serif;
    box-sizing: border-box;
  }
  #prayerInput {
    height: 100px;
    resize: vertical;
  }
  #prayer-list {
    margin-top: 30px;
    text-align: left;
  }
  .prayer-item {
    background: #f3f4f6;
    border-radius: 10px;
    padding: 18px 20px;
    margin-bottom: 16px;
    box-shadow: 0 2px 8px rgb(0 0 0 / 0.05);
    word-wrap: break-word;
  }
  .prayer-name {
    font-weight: 600;
    margin-bottom: 6px;
    color: #111;
  }
  .prayer-text {
    margin-bottom: 8px;
    white-space: pre-wrap;
    color: #333;
  }
  .prayer-time {
    font-size: 13px;
    color: #777;
  }
  /* Bold and Italics styling for headings */
  #verseTab > h2 {
    font-weight: 600;
  }
  #prayer {
    font-style: italic;
  }
  #prayerTab > h2 {
    font-weight: 600;
  }
  /* Responsive */
  @media(max-width: 640px) {
    #container {
      padding: 20px;
      margin: 10px;
    }
  }
</style>
</head>
<body>

<div id="container" role="main" aria-label="Bible app">
  <div id="menu" aria-haspopup="true" aria-expanded="false" tabindex="0" role="button" aria-label="Toggle menu" onclick="toggleMenu()" onkeydown="if(event.key==='Enter'){toggleMenu()}">☰</div>
  <ul class="menu-items" id="menu-items" role="menu" aria-label="Navigation menu">
    <li role="menuitem" tabindex="0" onclick="showVerseTab()" onkeydown="if(event.key==='Enter'){showVerseTab()}">Verse of the Day</li>
    <li role="menuitem" tabindex="0" onclick="showPrayerTab()" onkeydown="if(event.key==='Enter'){showPrayerTab()}">Prayer Wall</li>
  </ul>

  <!-- Verse of the Day Section -->
  <section id="verseTab" aria-live="polite" aria-atomic="true">
    <h2>Verse of the Day</h2>
    <p id="date" aria-label="Current date"></p>
    <p id="verse" aria-label="Bible verse">Loading verse...</p>
    <p id="prayer" aria-label="Related prayer"></p>
    <img id="bible-image" src="" alt="Bible related image" />
    <button onclick="fetchRandomVerse()" aria-label="Generate new Bible verse">Generate New Verse</button>
  </section>

  <!-- Prayer Wall Section -->
  <section id="prayerTab" style="display:none;">
    <h2>Prayer Wall</h2>
    <input id="name" placeholder="Your Name (optional)" aria-label="Name input" />
    <textarea id="prayerInput" placeholder="Write your prayer here..." aria-label="Prayer input"></textarea>
    <button onclick="submitPrayer()" aria-label="Submit prayer">Submit Prayer</button>
    <div id="prayer-list" aria-live="polite" aria-atomic="false"></div>
  </section>
</div>

<!-- Background Music -->
<audio id="bg-music" src="media/music.mp3" loop muted></audio>

<script>
  // Top 30 meaningful Bible verses with prayers (praise, repent, ask, yield)
  const verses = [
    {
      verse: "John 3:16",
      text: "For God so loved the world that he gave his one and only Son, that whoever believes in him shall not perish but have eternal life.",
      prayer: "Heavenly Father, we praise Your boundless love and grace. We repent for the times we've doubted Your mercy. We ask for faith to believe fully and eternal life in Your presence. We yield our hearts to Your perfect will. Amen."
    },
    {
      verse: "Psalm 23:1",
      text: "The Lord is my shepherd, I lack nothing.",
      prayer: "Lord, we praise You as our shepherd who provides all we need. We repent when we try to rely on our own strength. We ask for guidance and provision. We yield to Your care and protection always. Amen."
    },
    {
      verse: "Philippians 4:13",
      text: "I can do all this through him who gives me strength.",
      prayer: "God, we praise Your empowering presence in our lives. We repent of weakness and fear. We ask for strength to face every challenge. We yield to Your sustaining power each day. Amen."
    },
    {
      verse: "Romans 8:28",
      text: "And we know that in all things God works for the good of those who love him, who have been called according to his purpose.",
      prayer: "Father, we praise Your sovereignty and goodness. We repent when we fail to trust Your plan. We ask for peace in trials. We yield to Your perfect purpose for our lives. Amen."
    },
    {
      verse: "Jeremiah 29:11",
      text: "For I know the plans I have for you, declares the Lord, plans to prosper you and not to harm you, plans to give you hope and a future.",
      prayer: "Lord, we praise Your promise of hope and a future. We repent of doubt and anxiety. We ask for assurance in Your plans. We yield to Your guidance and timing. Amen."
    },
    {
      verse: "Isaiah 41:10",
      text: "So do not fear, for I am with you; do not be dismayed, for I am your God.",
      prayer: "God, we praise Your faithful presence. We repent of our fears and worries. We ask for courage and comfort. We yield our lives into Your loving hands. Amen."
    },
    {
      verse: "Proverbs 3:5-6",
      text: "Trust in the Lord with all your heart and lean not on your own understanding; in all your ways submit to him, and he will make your paths straight.",
      prayer: "Lord, we praise Your guidance and wisdom. We repent when we rely on ourselves. We ask for trust and submission. We yield our paths to Your leading. Amen."
    },
    {
      verse: "Matthew 6:33",
      text: "But seek first his kingdom and his righteousness, and all these things will be given to you as well.",
      prayer: "Heavenly Father, we praise Your kingdom above all else. We repent of distractions and selfish desires. We ask for a heart that prioritizes You. We yield to Your righteousness daily. Amen."
    },
    {
      verse: "2 Corinthians 12:9",
      text: "My grace is sufficient for you, for my power is made perfect in weakness.",
      prayer: "Lord, we praise Your abundant grace. We repent of pride and self-reliance. We ask for humility and strength through You. We yield in our weakness to Your power. Amen."
    },
    {
      verse: "Psalm 46:1",
      text: "God is our refuge and strength, an ever-present help in trouble.",
      prayer: "God, we praise You as our refuge and strength. We repent when we seek help elsewhere. We ask for Your presence in trouble. We yield to Your protection and peace. Amen."
    },
    {
      verse: "Romans 12:2",
      text: "Do not conform to the pattern of this world, but be transformed by the renewing of your mind.",
      prayer: "Lord, we praise Your power to transform. We repent of worldly conformity. We ask for renewal and clarity. We yield our minds and hearts to You. Amen."
    },
    {
      verse: "Hebrews 11:1",
      text: "Now faith is confidence in what we hope for and assurance about what we do not see.",
      prayer: "Father, we praise the gift of faith. We repent of doubt and unbelief. We ask for confidence in Your promises. We yield to trust in Your unseen ways. Amen."
    },
    {
      verse: "Psalm 37:4",
      text: "Take delight in the Lord, and he will give you the desires of your heart.",
      prayer: "Lord, we praise the joy found in You. We repent of selfish desires. We ask for a heart aligned with Yours. We yield to delighting in Your will. Amen."
    },
    {
      verse: "Galatians 5:22-23",
      text: "But the fruit of the Spirit is love, joy, peace, forbearance, kindness, goodness, faithfulness, gentleness and self-control.",
      prayer: "Holy Spirit, we praise Your fruit in our lives. We repent of lacking these qualities. We ask for growth in Your fruit. We yield fully to Your work in us. Amen."
    },
    {
      verse: "John 14:6",
      text: "Jesus answered, 'I am the way and the truth and the life. No one comes to the Father except through me.'",
      prayer: "Jesus, we praise You as the only way. We repent of trying to find our own way. We ask for clear understanding and faith. We yield our lives to You alone. Amen."
    },
    {
      verse: "Matthew 11:28",
      text: "Come to me, all you who are weary and burdened, and I will give you rest.",
      prayer: "Lord, we praise Your invitation to rest. We repent of carrying burdens alone. We ask for Your peace and rest. We yield our weariness to You. Amen."
    },
    {
      verse: "Ephesians 2:8",
      text: "For it is by grace you have been saved, through faith—and this is not from yourselves, it is the gift of God.",
      prayer: "Father, we praise Your amazing grace. We repent of trying to earn salvation. We ask for faith to receive Your gift. We yield fully to Your grace. Amen."
    },
    {
      verse: "James 1:5",
      text: "If any of you lacks wisdom, you should ask God, who gives generously to all without finding fault.",
      prayer: "God, we praise Your generosity. We repent when we neglect to seek wisdom. We ask for Your guidance and understanding. We yield to Your wise counsel. Amen."
    },
    {
      verse: "Psalm 34:18",
      text: "The Lord is close to the brokenhearted and saves those who are crushed in spirit.",
      prayer: "Lord, we praise Your nearness in pain. We repent of feeling alone. We ask for comfort and healing. We yield our broken hearts to You. Amen."
    },
    {
      verse: "Colossians 3:23",
      text: "Whatever you do, work at it with all your heart, as working for the Lord, not for human masters.",
      prayer: "Lord, we praise the call to wholehearted service. We repent of half-hearted efforts. We ask for passion and diligence. We yield all our work to Your glory. Amen."
    },
    {
      verse: "Isaiah 40:31",
      text: "But those who hope in the Lord will renew their strength. They will soar on wings like eagles.",
      prayer: "God, we praise Your renewing strength. We repent of losing hope. We ask for renewed courage. We yield our weakness and soar in Your power. Amen."
    },
    {
      verse: "1 Peter 5:7",
      text: "Cast all your anxiety on him because he cares for you.",
      prayer: "Lord, we praise Your caring heart. We repent of anxiety and worry. We ask for peace and trust. We yield all our cares to You. Amen."
    },
    {
      verse: "John 16:33",
      text: "In this world you will have trouble. But take heart! I have overcome the world.",
      prayer: "Jesus, we praise Your victory over trouble. We repent of fear and discouragement. We ask for courage to endure. We yield to Your victorious peace. Amen."
    },
    {
      verse: "2 Timothy 1:7",
      text: "For the Spirit God gave us does not make us timid, but gives us power, love and self-discipline.",
      prayer: "Holy Spirit, we praise Your gifts of power, love, and self-control. We repent of timidity and fear. We ask for boldness and discipline. We yield to Your empowering presence. Amen."
    },
    {
      verse: "Psalm 119:105",
      text: "Your word is a lamp to my feet and a light to my path.",
      prayer: "Lord, we praise Your guiding Word. We repent of ignoring Your guidance. We ask for clarity and direction. We yield our paths to Your light. Amen."
    },
    {
      verse: "Matthew 5:16",
      text: "Let your light shine before others, that they may see your good deeds and glorify your Father in heaven.",
      prayer: "Father, we praise the call to shine for You. We repent of hiding our light. We ask for courage to live boldly. We yield to glorify You in all we do. Amen."
    },
    {
      verse: "Philippians 4:6",
      text: "Do not be anxious about anything, but in every situation, by prayer and petition, with thanksgiving, present your requests to God.",
      prayer: "Lord, we praise Your peace that surpasses understanding. We repent of worry and doubt. We ask for faithful prayer and thanksgiving. We yield our anxieties to You daily. Amen."
    },
    {
      verse: "Romans 5:8",
      text: "But God demonstrates his own love for us in this: While we were still sinners, Christ died for us.",
      prayer: "God, we praise Your unconditional love. We repent of sin and rebellion. We ask for grateful hearts. We yield fully to Your redeeming love. Amen."
    },
    {
      verse: "Hebrews 13:5",
      text: "Never will I leave you; never will I forsake you.",
      prayer: "Lord, we praise Your faithful presence. We repent of feeling abandoned. We ask for assurance and comfort. We yield to Your eternal companionship. Amen."
    }
  ];

  // Curated stable Bible-related splash images with retry on error
  const splashImages = [
    "https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=800&q=80", // Bible with cross
    "https://images.unsplash.com/photo-1486308510493-cb1247b30b3e?auto=format&fit=crop&w=800&q=80", // Church interior
    "https://images.unsplash.com/photo-1465812581817-22d4a1a920f6?auto=format&fit=crop&w=800&q=80", // Hands holding Bible
    "https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=800&q=80", // Cross on sunset
    "https://images.unsplash.com/photo-1536859355446-7a9364aaf072?auto=format&fit=crop&w=800&q=80", // Open Bible
    "https://images.unsplash.com/photo-1508672019048-805c876b67e2?auto=format&fit=crop&w=800&q=80", // Bible pages
    "https://images.unsplash.com/photo-1489515217757-5fd1be406fef?auto=format&fit=crop&w=800&q=80", // Wooden cross on grass
    "https://images.unsplash.com/photo-1553163147-622ab57b8d29?auto=format&fit=crop&w=800&q=80", // Church window with cross
    "https://images.unsplash.com/photo-1504494683947-2c9f166f948e?auto=format&fit=crop&w=800&q=80", // Praying hands
    "https://images.unsplash.com/photo-1501584931734-2f303a5e1a9c?auto=format&fit=crop&w=800&q=80", // Candle and Bible
    "https://images.unsplash.com/photo-1501436513147-5ec1ed041d57?auto=format&fit=crop&w=800&q=80", // Bible and cross on table
    "https://images.unsplash.com/photo-1505462687922-16eaba38e375?auto=format&fit=crop&w=800&q=80"  // Cross necklace
  ];

  // Utility random integer function
  function randomInt(max) {
    return Math.floor(Math.random() * max);
  }

  // Load image with retry if fails, maxRetries = 5
  function loadImageWithRetry(imgElement, maxRetries = 5) {
    let retries = 0;
    function tryLoad() {
      const idx = randomInt(splashImages.length);
      const url = splashImages[idx];
      imgElement.src = url;

      imgElement.onerror = () => {
        retries++;
        if (retries < maxRetries) {
          tryLoad();
        } else {
          imgElement.src = "https://via.placeholder.com/600x400?text=Image+not+available";
        }
      };

      imgElement.onload = () => {
        // Image loaded successfully, clear error handler to avoid retries firing unnecessarily
        imgElement.onerror = null;
      };
    }
    tryLoad();
  }

  // Toggle menu display
  function toggleMenu() {
    const menu = document.getElementById('menu-items');
    const expanded = document.getElementById('menu').getAttribute('aria-expanded') === 'true';
    document.getElementById('menu').setAttribute('aria-expanded', (!expanded).toString());
    menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
  }

  // Show Verse tab, hide Prayer tab
  function showVerseTab() {
    document.getElementById('verseTab').style.display = 'block';
    document.getElementById('prayerTab').style.display = 'none';
    document.getElementById('menu-items').style.display = 'none';
    document.getElementById('menu').setAttribute('aria-expanded', 'false');
  }

  // Show Prayer tab, hide Verse tab
  function showPrayerTab() {
    document.getElementById('prayerTab').style.display = 'block';
    document.getElementById('verseTab').style.display = 'none';
    document.getElementById('menu-items').style.display = 'none';
    document.getElementById('menu').setAttribute('aria-expanded', 'false');
  }

  // Display today's date
  function displayDate() {
    const today = new Date();
    const options = { weekday:'long', year:'numeric', month:'long', day:'numeric' };
    document.getElementById('date').textContent = today.toLocaleDateString('en-US', options);
  }

  // Escape text for HTML insertion
  function escapeHtml(text) {
    const map = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#039;' };
    return text.replace(/[&<>"']/g, m => map[m]);
  }

  // Display stored prayers from localStorage
  function displayPrayers() {
    const list = document.getElementById('prayer-list');
    list.innerHTML = '';

    let prayers = JSON.parse(localStorage.getItem('prayers')) || [];

    prayers.forEach(p => {
      const div = document.createElement('div');
      div.className = 'prayer-item';

      div.innerHTML =
        `<div class="prayer-name">${escapeHtml(p.name)}</div>
         <div class="prayer-text">${escapeHtml(p.prayer)}</div>
         <div class="prayer-time">${p.date} at ${p.time}</div>`;

      list.appendChild(div);
    });
  }

  // Submit a prayer and store it
  function submitPrayer() {
    const nameInput = document.getElementById('name').value.trim();
    const prayerInput = document.getElementById('prayerInput').value.trim();

    if (!prayerInput) {
      alert("Please enter your prayer before submitting.");
      return;
    }

    const name = nameInput || "Anonymous";
    const now = new Date();
    const dateOptions = { year:'numeric', month:'long', day:'numeric' };
    const timeOptions = { hour:'2-digit', minute:'2-digit', second:'2-digit', hour12:true };
    const date = now.toLocaleDateString('en-US', dateOptions);
    const time = now.toLocaleTimeString('en-US', timeOptions);

    const newPrayer = { name, prayer: prayerInput, date, time };

    let prayers = JSON.parse(localStorage.getItem('prayers')) || [];
    prayers.unshift(newPrayer);
    localStorage.setItem('prayers', JSON.stringify(prayers));

    displayPrayers();

    document.getElementById('name').value = '';
    document.getElementById('prayerInput').value = '';
  }

  // Show a random verse with prayer and image
  function fetchRandomVerse() {
    const idx = randomInt(verses.length);
    const verseObj = verses[idx];

    document.getElementById('verse').textContent = `${verseObj.verse} - "${verseObj.text}"`;
    document.getElementById('prayer').textContent = verseObj.prayer;

    const imgElement = document.getElementById('bible-image');
    loadImageWithRetry(imgElement);
    imgElement.alt = `Bible related image for ${verseObj.verse}`;
  }

  // Attempt to play music on first user interaction
  function enableMusicOnInteraction() {
    const music = document.getElementById('bg-music');
    if (music.paused) {
      music.muted = false;
      music.play().catch(() => {
        // Autoplay might be blocked; keep muted or try later
        music.muted = true;
      });
    }
    // Remove listener after first use
    window.removeEventListener('click', enableMusicOnInteraction);
    window.removeEventListener('keydown', enableMusicOnInteraction);
  }

  window.onload = () => {
    displayDate();
    fetchRandomVerse();
    displayPrayers();

    // Setup music to autoplay unmuted on first interaction (click or keydown)
    window.addEventListener('click', enableMusicOnInteraction);
    window.addEventListener('keydown', enableMusicOnInteraction);
  };
</script>

</body>
</html>
